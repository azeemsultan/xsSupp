{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\RBTG\\\\Desktop\\\\FYP-Code\\\\fyp\\\\fyp-frontend\\\\src\\\\Component\\\\customer\\\\Stripecard.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport TextField from '@material-ui/core/TextField';\nimport { useStripe, useElements, CardElement } from '@stripe/react-stripe-js';\nimport { makeStyles } from '@material-ui/core/styles';\nimport CardInput from './CardInput';\nimport * as paymentService from '../../Axios-Actions/paymentService';\nimport { Container, Typography } from '@material-ui/core';\nconst useStyles = makeStyles({\n  root: {\n    maxWidth: 600,\n    margin: '35vh auto'\n  },\n  content: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignContent: 'flex-start'\n  },\n  div: {\n    display: 'flex',\n    flexDirection: 'row',\n    alignContent: 'flex-start',\n    justifyContent: 'space-between'\n  },\n  button: {\n    margin: '2em auto 1em'\n  }\n});\n\nfunction Stripecard() {\n  _s();\n\n  const classes = useStyles(); // State\n\n  const [email, setEmail] = useState('');\n  const [task, setTask] = useState([]);\n  const stripe = useStripe();\n  const elements = useElements();\n  React.useEffect(() => {\n    paymentService.getAllTask().then(result => {\n      console.log(result.data);\n      setTask(result.data);\n    });\n  }, []);\n\n  const handleSubmit = async event => {\n    if (!stripe || !elements) {\n      // Stripe.js has not yet loaded.\n      // Make sure to disable form submission until Stripe.js has loaded.\n      return;\n    }\n\n    const res = await paymentService.Payment(email, task.month * task.permonth + task.pertask + task.perhour * (parseInt(task.endtime) - parseInt(task.starttime)) * (task.month * 30));\n    paymentService.paymentbyCard(); //   const res = await axios.post('http://localhost:3000/pay', {email: email});\n\n    const clientSecret = res.data['client_secret'];\n    const result = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details: {\n          email: email\n        }\n      }\n    });\n\n    if (result.error) {\n      // Show error to your customer (e.g., insufficient funds)\n      console.log(result.error.message);\n    } else {\n      // The payment has been processed!\n      if (result.paymentIntent.status === 'succeeded') {\n        console.log('Money is in the bank!');\n        setTimeout(function () {\n          window.location = \"/profile\";\n        }, 2000); // Show a success message to your customer\n        // There's a risk of the customer closing the window before callback\n        // execution. Set up a webhook or plugin to listen for the\n        // payment_intent.succeeded event that handles any business critical\n        // post-payment actions.\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    maxWidth: \"md\",\n    children: /*#__PURE__*/_jsxDEV(Card, {\n      className: classes.root,\n      children: /*#__PURE__*/_jsxDEV(CardContent, {\n        className: classes.content,\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          children: [\"Your Account Email:\", task.customeremail]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 2\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          children: [\"Your Service Provider Email:\", task.serviceprovideremail]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 2\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          children: [\"Your Total bill:\", task.month * task.permonth + task.pertask + task.perhour * (parseInt(task.endtime) - parseInt(task.starttime)) * (task.month * 30)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 2\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          label: \"Email\",\n          id: \"outlined-email-input\",\n          helperText: `Email you'll recive updates and receipts on`,\n          margin: \"normal\",\n          variant: \"outlined\",\n          type: \"email\",\n          required: true,\n          value: email,\n          onChange: e => setEmail(e.target.value),\n          fullWidth: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(CardInput, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.div,\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            color: \"primary\",\n            className: classes.button,\n            onClick: handleSubmit,\n            children: \"Pay\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            color: \"primary\",\n            className: classes.button,\n            children: \"Subscription\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Stripecard, \"EY69ONwelgY9Ce2oIveIUgb66ks=\", false, function () {\n  return [useStyles, useStripe, useElements];\n});\n\n_c = Stripecard;\nexport default Stripecard;\n\nvar _c;\n\n$RefreshReg$(_c, \"Stripecard\");","map":{"version":3,"sources":["C:/Users/RBTG/Desktop/FYP-Code/fyp/fyp-frontend/src/Component/customer/Stripecard.js"],"names":["React","useEffect","useState","Button","Card","CardContent","TextField","useStripe","useElements","CardElement","makeStyles","CardInput","paymentService","Container","Typography","useStyles","root","maxWidth","margin","content","display","flexDirection","alignContent","div","justifyContent","button","Stripecard","classes","email","setEmail","task","setTask","stripe","elements","getAllTask","then","result","console","log","data","handleSubmit","event","res","Payment","month","permonth","pertask","perhour","parseInt","endtime","starttime","paymentbyCard","clientSecret","confirmCardPayment","payment_method","card","getElement","billing_details","error","message","paymentIntent","status","setTimeout","window","location","customeremail","serviceprovideremail","e","target","value"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport {useStripe, useElements, CardElement} from '@stripe/react-stripe-js';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport CardInput from './CardInput';\r\nimport * as paymentService from '../../Axios-Actions/paymentService';\r\nimport { Container, Typography } from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    maxWidth: 600,\r\n    margin: '35vh auto',\r\n  },\r\n  content: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignContent: 'flex-start',\r\n  },\r\n  div: {\r\n    display: 'flex',\r\n    flexDirection: 'row',\r\n    alignContent: 'flex-start',\r\n    justifyContent: 'space-between',\r\n  },\r\n  button: {\r\n    margin: '2em auto 1em',\r\n  },\r\n});\r\n\r\n function Stripecard() {\r\n  const classes = useStyles();\r\n  // State\r\n  const [email, setEmail] = useState('');\r\n  const [task,setTask]    = useState([]); \r\n  const stripe = useStripe();\r\n  const elements = useElements();\r\n  React.useEffect(() => {\r\n    paymentService.getAllTask()\r\n    .then((result)=>{\r\n      console.log(result.data);\r\n       setTask(result.data);\r\n    })\r\n  \r\n  },[]);\r\n\r\n  const handleSubmit = async (event) => {\r\n    if (!stripe || !elements) {\r\n      // Stripe.js has not yet loaded.\r\n      // Make sure to disable form submission until Stripe.js has loaded.\r\n      return;\r\n    }\r\n     const res=await paymentService.Payment(email,(task.month*task.permonth)+(task.pertask)+(task.perhour*(parseInt(task.endtime)-parseInt(task.starttime))*(task.month*30)));\r\n     paymentService.paymentbyCard();\r\n\r\n //   const res = await axios.post('http://localhost:3000/pay', {email: email});\r\n\r\n    const clientSecret = res.data['client_secret'];\r\n\r\n    const result = await stripe.confirmCardPayment(clientSecret, {\r\n      payment_method: {\r\n        card: elements.getElement(CardElement),\r\n        billing_details: {\r\n          email: email,\r\n        },\r\n      },\r\n    });\r\n\r\n    if (result.error) {\r\n      // Show error to your customer (e.g., insufficient funds)\r\n      console.log(result.error.message);\r\n    } else {\r\n      // The payment has been processed!\r\n      if (result.paymentIntent.status === 'succeeded') {\r\n        console.log('Money is in the bank!');\r\n              setTimeout(function () {\r\n                window.location = \"/profile\";\r\n              }, 2000);\r\n        // Show a success message to your customer\r\n        // There's a risk of the customer closing the window before callback\r\n        // execution. Set up a webhook or plugin to listen for the\r\n        // payment_intent.succeeded event that handles any business critical\r\n        // post-payment actions.\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Container maxWidth=\"md\">\r\n    <Card className={classes.root}>\r\n      <CardContent className={classes.content}>\r\n\r\n <Typography>Your Account Email:{task.customeremail}</Typography>\r\n <Typography>Your Service Provider Email:{task.serviceprovideremail}</Typography>\r\n <Typography>Your Total bill:{(task.month*task.permonth)+(task.pertask)+(task.perhour*(parseInt(task.endtime)-parseInt(task.starttime))*(task.month*30))}</Typography>\r\n\r\n      \r\n        <TextField\r\n          label='Email'\r\n          id='outlined-email-input'\r\n          helperText={`Email you'll recive updates and receipts on`}\r\n          margin='normal'\r\n          variant='outlined'\r\n          type='email'\r\n          required\r\n          value={email}\r\n          onChange={(e) => setEmail(e.target.value)}\r\n          fullWidth\r\n        />\r\n        <CardInput />\r\n        <div className={classes.div}>\r\n          <Button variant=\"contained\" color=\"primary\" className={classes.button} onClick={handleSubmit}>\r\n            Pay\r\n          </Button>\r\n          <Button variant=\"contained\" color=\"primary\" className={classes.button}>\r\n            Subscription\r\n          </Button>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default Stripecard;"]},"metadata":{},"sourceType":"module"}